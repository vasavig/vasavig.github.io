<html>
<head>
<title>Recognition with Bag of Words</title>
<link href='http://fonts.googleapis.com/css?family=Nunito:300|Crimson+Text|Droid+Sans+Mono' rel='stylesheet' type='text/css'>
<link rel="stylesheet" title="Default" href="styles/github.css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>  

<link rel="stylesheet" href="highlighting/styles/default.css">
<script src="highlighting/highlight.pack.js"></script>

<style type="text/css">
body {
	margin: 0px;
	width: 100%;
	font-family: 'Crimson Text', serif;
	font-size: 20px;
	background: #fcfcfc;
}
h1 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 28px;
	margin: 25px 0px 0px 0px;
	text-transform: lowercase;

}

h2 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 32px;
	margin: 15px 0px 35px 0px;
	color: #333;	
	word-spacing: 3px;
}

h3 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 26px;
	margin: 10px 0px 10px 0px;
	color: #333;
	word-spacing: 2px;
}
h4 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 22px;
	margin: 10px 0px 10px 0px;
	color: #333;
	word-spacing: 2px;
}

h5 {
	font-family: 'Nunito', sans-serif;
	font-weight: normal;
	font-size: 18px;
	margin: 10px 0px 10px 0px;
	color: #111;
	word-spacing: 2px;
}

p, li {
	color: #444;
}

a {
	color: #DE3737;
}

.container {
	margin: 0px auto 0px auto;
	width: 1160px;
}

#header {
	background: #333;
	width: 100%;
}

#headersub {
	color: #ccc;
	width: 960px;
	margin: 0px auto 0px auto;
	padding: 20px 0px 20px 0px;
}

.chart {
	width: 480px;
}
.lol {
	font-size: 16px;
	color: #888;
	font-style: italic;
}
.sep {
	height: 1px;
	width: 100%;
	background: #999;
	margin: 20px 0px 20px 0px;
}
.footer{
	font-size: 16px;
}
.latex {
	width: 100%;
}

.latex img {
	display: block;
	margin: 0px auto 0px auto;
}

pre {
	font-family: 'Droid Sans Mono';
	font-size: 14px;
}

table td {
  text-align: center;
  vertical-align: middle;
}

table td img {
  text-align: center;
  vertical-align: middle;
}

#contents a {
}
</style>
<script type="text/javascript">
    hljs.initHighlightingOnLoad();
</script>
</head>
<body>
<div id="header" >
<div id="headersub">
<h1>Vasavi Gajarla</h1>
</div>
</div>
<div class="container" style="margin-left: 45px">

<h2>Project 4 / Scene Recognition with Bag of Words</h2>

</div>
<div style="margin-left: 45px";"margin-right: 45px">
<p>This report presents various classification methods and their performances for 15 scenes database. It starts off with showing accuracy values for tiny images + nearest neighbors, bag of sifts + nearest neighbors, bag of sifts + svm. It also shows the results of classification on pre-trained imagenet model. A few other variations of accuracy with SIFT vocabulary size, random cross validation etc are also presented.</p>

<h3>Results of Classification using various models</h3>
<p>The following table of pictures shows the accuracy of classification for tiny images + nearest neighbor classification, bag of sifts + k-nearest neighbor(kNN, k = 7 in this project) classification, and the confusion matrix and classifer results of bag of sifts + Support Vector Machines (SVM)</p>

<img src="accuracies.jpg" style="float: middle; width: 40%; height: 200px; margin-left: 20em; margin-bottom: 1em;">
<div style="margin-left:45px">
<img src="confusion_matrix_svm_bos.png" style="float: middle; width: 50%; height: 500px; margin-left: 15em; margin-bottom: 1em;">

<br>
Accuracy for bag of sifts + Support Vector Machines (mean of diagonal of confusion matrix) is 0.657
<p>

<table border=0 cellpadding=4 cellspacing=1>
<tr>
<th>Category name</th>
<th>Accuracy</th>
<th colspan=2>Sample training images</th>
<th colspan=2>Sample true positives</th>
<th colspan=2>False positives with true label</th>
<th colspan=2>False negatives with wrong predicted label</th>
</tr>
<tr>
<td>Kitchen</td>
<td>0.390</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Kitchen_image_0007.jpg" width=100 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Kitchen_image_0092.jpg" width=113 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Kitchen_image_0104.jpg" width=115 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Kitchen_image_0057.jpg" width=105 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/InsideCity_image_0119.jpg" width=75 height=75><br><small>InsideCity</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/LivingRoom_image_0049.jpg" width=106 height=75><br><small>LivingRoom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Kitchen_image_0093.jpg" width=99 height=75><br><small>Bedroom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Kitchen_image_0095.jpg" width=102 height=75><br><small>Store</small></td>
</tr>
<tr>
<td>Store</td>
<td>0.550</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Store_image_0051.jpg" width=100 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Store_image_0234.jpg" width=114 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Store_image_0010.jpg" width=104 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Store_image_0048.jpg" width=100 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/InsideCity_image_0013.jpg" width=75 height=75><br><small>InsideCity</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Industrial_image_0085.jpg" width=112 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Store_image_0138.jpg" width=100 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Store_image_0057.jpg" width=100 height=75><br><small>Office</small></td>
</tr>
<tr>
<td>Bedroom</td>
<td>0.490</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Bedroom_image_0055.jpg" width=100 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Bedroom_image_0146.jpg" width=105 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Bedroom_image_0157.jpg" width=90 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Bedroom_image_0168.jpg" width=113 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Kitchen_image_0090.jpg" width=113 height=75><br><small>Kitchen</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Kitchen_image_0150.jpg" width=100 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Bedroom_image_0050.jpg" width=113 height=75><br><small>Store</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Bedroom_image_0117.jpg" width=52 height=75><br><small>Office</small></td>
</tr>
<tr>
<td>LivingRoom</td>
<td>0.380</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/LivingRoom_image_0188.jpg" width=100 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/LivingRoom_image_0192.jpg" width=100 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/LivingRoom_image_0039.jpg" width=101 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/LivingRoom_image_0025.jpg" width=57 height=76></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Store_image_0071.jpg" width=54 height=75><br><small>Store</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Kitchen_image_0192.jpg" width=100 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/LivingRoom_image_0021.jpg" width=109 height=75><br><small>Bedroom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/LivingRoom_image_0107.jpg" width=129 height=75><br><small>InsideCity</small></td>
</tr>
<tr>
<td>Office</td>
<td>0.870</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Office_image_0085.jpg" width=85 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Office_image_0013.jpg" width=92 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Office_image_0140.jpg" width=103 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Office_image_0019.jpg" width=101 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Kitchen_image_0033.jpg" width=57 height=75><br><small>Kitchen</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/InsideCity_image_0002.jpg" width=75 height=75><br><small>InsideCity</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Office_image_0144.jpg" width=115 height=75><br><small>Bedroom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Office_image_0102.jpg" width=132 height=75><br><small>Bedroom</small></td>
</tr>
<tr>
<td>Industrial</td>
<td>0.560</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Industrial_image_0267.jpg" width=123 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Industrial_image_0112.jpg" width=100 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Industrial_image_0006.jpg" width=114 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Industrial_image_0083.jpg" width=106 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Bedroom_image_0059.jpg" width=110 height=75><br><small>Bedroom</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/LivingRoom_image_0041.jpg" width=113 height=75><br><small>LivingRoom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Industrial_image_0066.jpg" width=123 height=75><br><small>InsideCity</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Industrial_image_0025.jpg" width=118 height=75><br><small>Store</small></td>
</tr>
<tr>
<td>Suburb</td>
<td>0.930</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Suburb_image_0112.jpg" width=113 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Suburb_image_0058.jpg" width=113 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Suburb_image_0005.jpg" width=113 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Suburb_image_0154.jpg" width=113 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Mountain_image_0076.jpg" width=75 height=75><br><small>Mountain</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Kitchen_image_0113.jpg" width=113 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Suburb_image_0004.jpg" width=113 height=75><br><small>LivingRoom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Suburb_image_0120.jpg" width=113 height=75><br><small>Industrial</small></td>
</tr>
<tr>
<td>InsideCity</td>
<td>0.490</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/InsideCity_image_0211.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/InsideCity_image_0295.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/InsideCity_image_0011.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/InsideCity_image_0004.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/LivingRoom_image_0073.jpg" width=100 height=75><br><small>LivingRoom</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Store_image_0136.jpg" width=70 height=75><br><small>Store</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/InsideCity_image_0127.jpg" width=75 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/InsideCity_image_0065.jpg" width=75 height=75><br><small>Kitchen</small></td>
</tr>
<tr>
<td>TallBuilding</td>
<td>0.710</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/TallBuilding_image_0261.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/TallBuilding_image_0350.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/TallBuilding_image_0039.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/TallBuilding_image_0009.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Industrial_image_0117.jpg" width=102 height=75><br><small>Industrial</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/OpenCountry_image_0064.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/TallBuilding_image_0085.jpg" width=75 height=75><br><small>Coast</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/TallBuilding_image_0096.jpg" width=75 height=75><br><small>Bedroom</small></td>
</tr>
<tr>
<td>Street</td>
<td>0.640</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Street_image_0095.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Street_image_0290.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Street_image_0102.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Street_image_0129.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Mountain_image_0047.jpg" width=75 height=75><br><small>Mountain</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Mountain_image_0038.jpg" width=75 height=75><br><small>Mountain</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Street_image_0064.jpg" width=75 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Street_image_0101.jpg" width=75 height=75><br><small>Highway</small></td>
</tr>
<tr>
<td>Highway</td>
<td>0.830</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Highway_image_0081.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Highway_image_0055.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Highway_image_0142.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Highway_image_0155.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/OpenCountry_image_0042.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Mountain_image_0059.jpg" width=75 height=75><br><small>Mountain</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Highway_image_0031.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Highway_image_0140.jpg" width=75 height=75><br><small>OpenCountry</small></td>
</tr>
<tr>
<td>OpenCountry</td>
<td>0.570</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/OpenCountry_image_0390.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/OpenCountry_image_0213.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/OpenCountry_image_0050.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/OpenCountry_image_0125.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Coast_image_0101.jpg" width=75 height=75><br><small>Coast</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Coast_image_0004.jpg" width=75 height=75><br><small>Coast</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/OpenCountry_image_0052.jpg" width=75 height=75><br><small>TallBuilding</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/OpenCountry_image_0117.jpg" width=75 height=75><br><small>Coast</small></td>
</tr>
<tr>
<td>Coast</td>
<td>0.760</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Coast_image_0098.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Coast_image_0273.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Coast_image_0025.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Coast_image_0085.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/OpenCountry_image_0010.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/OpenCountry_image_0047.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Coast_image_0005.jpg" width=75 height=75><br><small>Mountain</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Coast_image_0086.jpg" width=75 height=75><br><small>Mountain</small></td>
</tr>
<tr>
<td>Mountain</td>
<td>0.770</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Mountain_image_0173.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Mountain_image_0321.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Mountain_image_0053.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Mountain_image_0098.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/Coast_image_0086.jpg" width=75 height=75><br><small>Coast</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/OpenCountry_image_0040.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Mountain_image_0005.jpg" width=75 height=75><br><small>Office</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Mountain_image_0008.jpg" width=75 height=75><br><small>Street</small></td>
</tr>
<tr>
<td>Forest</td>
<td>0.910</td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Forest_image_0193.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails_svm_bos/Forest_image_0039.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Forest_image_0048.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails_svm_bos/Forest_image_0089.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/OpenCountry_image_0005.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=LightCoral><img src="thumbnails_svm_bos/OpenCountry_image_0049.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Forest_image_0081.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails_svm_bos/Forest_image_0117.jpg" width=75 height=75><br><small>Mountain</small></td>
</tr>
<tr>
<th>Category name</th>
<th>Accuracy</th>
<th colspan=2>Sample training images</th>
<th colspan=2>Sample true positives</th>
<th colspan=2>False positives with true label</th>
<th colspan=2>False negatives with wrong predicted label</th>
</tr>
</table>
<div style="margin-right: 45px"; "margin-left: 0px">
<p>As can be seen, the results improve from top to bottom in the accuracy figure shown above. This makes sense as tiny images are devoid of some useful information which could make the classification perform better. Bag of sifts on the other hand utilize information from the whole of image in the form of 128 dimensional vectors. Also for the given heterogenous dataset, SVM performs better than kNN which is evident from the results. Building SIFT vocabulary and SIFT features for data is computationally expensive (takes around an hour for a vocab size of 400, step size of vocab = 8 and step size of sift features = 3). Making use of parallel pooling in Matlab (parfor in for loops to be precise) has reduced this time to about half on a multi-processing computer.</p>

<div>
<h3>Graduate Credit</h3>

<p>1) Convolutional Neural Networks(CNN) using pre-trained models: Using a 21 layered CNN of model of 'imagenet-vgg-f' data in MATLAB, and an SVM on the penultimate layer for the 15 scenes training data gave accuracies as high as 87% as can be seen from the below figure on left. This was expected as the neural network was trained on a 1000 category data over 21 layers (figure on right) leading to much accurate results. </p>
<img src="confusion_matrix_cnn.png" style="float: middle; width: 50%; height: 500px; margin-left: 15em; margin-bottom: 1em;">

<br>
Accuracy with convolution neural network pre-trained on imagenet data (mean of diagonal of confusion matrix) is 0.873
<p>

<table border=0 cellpadding=4 cellspacing=1>
<tr>
<th>Category name</th>
<th>Accuracy</th>
<th colspan=2>Sample training images</th>
<th colspan=2>Sample true positives</th>
<th colspan=2>False positives with true label</th>
<th colspan=2>False negatives with wrong predicted label</th>
</tr>
<tr>
<td>Kitchen</td>
<td>0.850</td>
<td bgcolor=LightBlue><img src="thumbnails/Kitchen_image_0081.jpg" width=133 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Kitchen_image_0025.jpg" width=57 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Kitchen_image_0175.jpg" width=100 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Kitchen_image_0170.jpg" width=100 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Office_image_0120.jpg" width=116 height=75><br><small>Office</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Industrial_image_0056.jpg" width=115 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Kitchen_image_0008.jpg" width=100 height=75><br><small>Bedroom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Kitchen_image_0135.jpg" width=100 height=75><br><small>LivingRoom</small></td>
</tr>
<tr>
<td>Store</td>
<td>0.900</td>
<td bgcolor=LightBlue><img src="thumbnails/Store_image_0064.jpg" width=57 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Store_image_0221.jpg" width=113 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Store_image_0046.jpg" width=57 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Store_image_0127.jpg" width=118 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Kitchen_image_0113.jpg" width=113 height=75><br><small>Kitchen</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Street_image_0041.jpg" width=75 height=75><br><small>Street</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Store_image_0143.jpg" width=113 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Store_image_0085.jpg" width=81 height=75><br><small>Kitchen</small></td>
</tr>
<tr>
<td>Bedroom</td>
<td>0.830</td>
<td bgcolor=LightBlue><img src="thumbnails/Bedroom_image_0076.jpg" width=100 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Bedroom_image_0002.jpg" width=97 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Bedroom_image_0131.jpg" width=114 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Bedroom_image_0016.jpg" width=97 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/LivingRoom_image_0047.jpg" width=100 height=75><br><small>LivingRoom</small></td>
<td bgcolor=LightCoral><img src="thumbnails/LivingRoom_image_0081.jpg" width=101 height=75><br><small>LivingRoom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Bedroom_image_0021.jpg" width=113 height=75><br><small>LivingRoom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Bedroom_image_0047.jpg" width=101 height=75><br><small>Kitchen</small></td>
</tr>
<tr>
<td>LivingRoom</td>
<td>0.730</td>
<td bgcolor=LightBlue><img src="thumbnails/LivingRoom_image_0036.jpg" width=94 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/LivingRoom_image_0067.jpg" width=108 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/LivingRoom_image_0040.jpg" width=114 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/LivingRoom_image_0134.jpg" width=100 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Bedroom_image_0130.jpg" width=132 height=75><br><small>Bedroom</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Kitchen_image_0125.jpg" width=114 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/LivingRoom_image_0117.jpg" width=114 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/LivingRoom_image_0090.jpg" width=114 height=75><br><small>Kitchen</small></td>
</tr>
<tr>
<td>Office</td>
<td>0.910</td>
<td bgcolor=LightBlue><img src="thumbnails/Office_image_0042.jpg" width=118 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Office_image_0061.jpg" width=105 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Office_image_0064.jpg" width=93 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Office_image_0135.jpg" width=108 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Store_image_0116.jpg" width=71 height=75><br><small>Store</small></td>
<td bgcolor=LightCoral><img src="thumbnails/LivingRoom_image_0055.jpg" width=100 height=75><br><small>LivingRoom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Office_image_0062.jpg" width=110 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Office_image_0120.jpg" width=116 height=75><br><small>Kitchen</small></td>
</tr>
<tr>
<td>Industrial</td>
<td>0.790</td>
<td bgcolor=LightBlue><img src="thumbnails/Industrial_image_0082.jpg" width=54 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Industrial_image_0010.jpg" width=117 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Industrial_image_0121.jpg" width=118 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Industrial_image_0071.jpg" width=50 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/LivingRoom_image_0129.jpg" width=55 height=75><br><small>LivingRoom</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Store_image_0002.jpg" width=100 height=75><br><small>Store</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Industrial_image_0085.jpg" width=112 height=75><br><small>Store</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Industrial_image_0076.jpg" width=100 height=75><br><small>TallBuilding</small></td>
</tr>
<tr>
<td>Suburb</td>
<td>0.960</td>
<td bgcolor=LightBlue><img src="thumbnails/Suburb_image_0184.jpg" width=113 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Suburb_image_0218.jpg" width=113 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Suburb_image_0173.jpg" width=113 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Suburb_image_0077.jpg" width=113 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Highway_image_0035.jpg" width=75 height=75><br><small>Highway</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Industrial_image_0049.jpg" width=100 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Suburb_image_0003.jpg" width=113 height=75><br><small>InsideCity</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Suburb_image_0171.jpg" width=113 height=75><br><small>TallBuilding</small></td>
</tr>
<tr>
<td>InsideCity</td>
<td>0.860</td>
<td bgcolor=LightBlue><img src="thumbnails/InsideCity_image_0245.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/InsideCity_image_0230.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/InsideCity_image_0107.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/InsideCity_image_0041.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Industrial_image_0140.jpg" width=100 height=75><br><small>Industrial</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Industrial_image_0054.jpg" width=100 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/InsideCity_image_0119.jpg" width=75 height=75><br><small>Kitchen</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/InsideCity_image_0095.jpg" width=75 height=75><br><small>Kitchen</small></td>
</tr>
<tr>
<td>TallBuilding</td>
<td>0.950</td>
<td bgcolor=LightBlue><img src="thumbnails/TallBuilding_image_0049.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/TallBuilding_image_0033.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/TallBuilding_image_0054.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/TallBuilding_image_0022.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/InsideCity_image_0025.jpg" width=75 height=75><br><small>InsideCity</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Industrial_image_0001.jpg" width=67 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/TallBuilding_image_0064.jpg" width=75 height=75><br><small>Industrial</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/TallBuilding_image_0023.jpg" width=75 height=75><br><small>InsideCity</small></td>
</tr>
<tr>
<td>Street</td>
<td>0.940</td>
<td bgcolor=LightBlue><img src="thumbnails/Street_image_0139.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Street_image_0208.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Street_image_0136.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Street_image_0057.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Industrial_image_0021.jpg" width=100 height=75><br><small>Industrial</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Highway_image_0032.jpg" width=75 height=75><br><small>Highway</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Street_image_0013.jpg" width=75 height=75><br><small>LivingRoom</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Street_image_0049.jpg" width=75 height=75><br><small>Highway</small></td>
</tr>
<tr>
<td>Highway</td>
<td>0.940</td>
<td bgcolor=LightBlue><img src="thumbnails/Highway_image_0049.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Highway_image_0083.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Highway_image_0025.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Highway_image_0062.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/OpenCountry_image_0077.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=LightCoral><img src="thumbnails/OpenCountry_image_0052.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Highway_image_0020.jpg" width=75 height=75><br><small>Office</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Highway_image_0032.jpg" width=75 height=75><br><small>Street</small></td>
</tr>
<tr>
<td>OpenCountry</td>
<td>0.810</td>
<td bgcolor=LightBlue><img src="thumbnails/OpenCountry_image_0094.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/OpenCountry_image_0328.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/OpenCountry_image_0100.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/OpenCountry_image_0118.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/Coast_image_0097.jpg" width=75 height=75><br><small>Coast</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Highway_image_0133.jpg" width=75 height=75><br><small>Highway</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/OpenCountry_image_0115.jpg" width=75 height=75><br><small>Mountain</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/OpenCountry_image_0057.jpg" width=75 height=75><br><small>Forest</small></td>
</tr>
<tr>
<td>Coast</td>
<td>0.740</td>
<td bgcolor=LightBlue><img src="thumbnails/Coast_image_0198.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Coast_image_0065.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Coast_image_0014.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Coast_image_0020.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/OpenCountry_image_0097.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=LightCoral><img src="thumbnails/OpenCountry_image_0103.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Coast_image_0005.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Coast_image_0017.jpg" width=75 height=75><br><small>OpenCountry</small></td>
</tr>
<tr>
<td>Mountain</td>
<td>0.910</td>
<td bgcolor=LightBlue><img src="thumbnails/Mountain_image_0135.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Mountain_image_0044.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Mountain_image_0059.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Mountain_image_0031.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/OpenCountry_image_0107.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Coast_image_0064.jpg" width=75 height=75><br><small>Coast</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Mountain_image_0101.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Mountain_image_0097.jpg" width=75 height=75><br><small>OpenCountry</small></td>
</tr>
<tr>
<td>Forest</td>
<td>0.970</td>
<td bgcolor=LightBlue><img src="thumbnails/Forest_image_0162.jpg" width=75 height=75></td>
<td bgcolor=LightBlue><img src="thumbnails/Forest_image_0233.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Forest_image_0017.jpg" width=75 height=75></td>
<td bgcolor=LightGreen><img src="thumbnails/Forest_image_0076.jpg" width=75 height=75></td>
<td bgcolor=LightCoral><img src="thumbnails/OpenCountry_image_0057.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=LightCoral><img src="thumbnails/Mountain_image_0100.jpg" width=75 height=75><br><small>Mountain</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Forest_image_0080.jpg" width=75 height=75><br><small>OpenCountry</small></td>
<td bgcolor=#FFBB55><img src="thumbnails/Forest_image_0117.jpg" width=75 height=75><br><small>Mountain</small></td>
</tr>
<tr>
<th>Category name</th>
<th>Accuracy</th>
<th colspan=2>Sample training images</th>
<th colspan=2>Sample true positives</th>
<th colspan=2>False positives with true label</th>
<th colspan=2>False negatives with wrong predicted label</th>
</tr>
</table>
<p>2) Gist descriptor: As the name suggests, gist descriptors are those which retain scale and orientation information of various parts of the image, essentially the summary or gist of an image. These were added to the SIFT descriptor in order to see if it increases the accuracy. However, it was only 50.9% whereas just the SIFT descriptor gave 65.6% using SVM model, vocab size of 400 and equal step sizes. This might be because of the way the descriptors are aggregated per image. In this test, four SIFT features were concatenated to form a 512 dimensional vector so that the 512 dimensional gist descriptor could be added to the set of features of image as a whole. A better and intuitive way of aggregation might have resulted in a better performance. A visualization of "Coast" image gist descriptors can be seen in image below.</p>
<img src="Beach.jpg" style="float: middle; width: 50%; margin-left: 15em; margin-bottom: 1em;">
<div style="clear:both">
<p>3) Gaussian Pyramid: The images have been convoluted with a gaussian of size [5, 5] and sigma = 2 in three layers and the following results have been observed. Convolution operation on every image was computationally expensive and each run took more than 20 min to run. Since the gaussian pyramid essentially does sub-sampling of data, the image resolution keeps reducing and the accuracy is expected to go down as the scaling increases (as the pyramid layer number increases). Although, the number of layers are not high enough to get a concrete picture of variation, the accuracy does decrease drastically at the third layer of the pyramid.</p>
<img src="gaussian.jpg" style="float: middle; width: 40%; margin-left: 20em; margin-bottom: 1em;">

<h2>Extra Credit</h2>
<p>1) Variation of accuracy with vocabulary size of SIFT features: The results of variation of vocab size on accuracy has been calculated for bag of sifts + SVM classification in the table below. As expected the accuracy increases with vocab size because more and more information (more cluster centers/features) from images is used for training and testing later on by the SVM. All the values below are calculated with a step size of 10 in vocabulary building and step size of 8 in building the bags of SIFTS. </p>
<img src="vocab_size.jpg" style="float: middle; width: 40%; height: 300px; margin-left: 20em; margin-bottom: 1em;">
<div style="clear:both">
<p>2) Results of cross validation using random subsets of training test data: The following figure shows the results of how accuracy changes over random sampling of 100 elements of training data and 100 elements of testing data in 10 iterations. All the results have been calculated with a vocab size of 40. The performance looks decent with the overall average around 35-45% as relatively high cluster centers are included (40 centers in a training data of 100).</p>
<img src="cross-validation.jpg" style="float: middle; height: 450px; width: 40%; margin-left: 20em; margin-bottom: 1em;">
<div style="clear:both">
<p>3) Tuning of learning parameter using cross validation of training data: Using a training sample of 100 - 80 training data, 20 cross-validation data and a vocab size of 10, random values of lambda for SVM have been tested for. The following results were observed. After the end of 8 iterations, the lambda with maximum accuracy is selected for performing a classification on randomly sampled test data of 100 elements using the whole of training and cross-validation data for training the SVM. Because the vocab size is pretty good for the relatively small training data, acuracies are considerably high. Even though the number of iterations are not enough to find a concrete pattern, as expected the lowest lambda value of '0.0422' has given the highest accuracy of 25% and therefore has been selected for the final classification which also gave an accuracy of around 25%.</p>
<img src="tuning.jpg" style="float: middle; height: 450px; width: 50%; margin-left: 15em; margin-bottom: 1em;">


</body>
</html>
</body>
</html>